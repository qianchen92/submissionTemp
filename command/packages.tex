\usepackage{xcolor}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage[
  operators,      % Mathematical operators like \sample, \floor, \ceil, \abs, \norm, etc.
  adversary,      % Adversary-related commands
  landau,         % Landau notation (big O, etc.)
  probability,    % Probability notation
  sets,           % Set theory notation
  notions,        % Security notions and definitions
  logic,          % Logic operators
  ff,             % Finite field notation
  mm,             % Modular arithmetic
  advantage,      % Advantage notation for cryptography
  primitives,     % Cryptographic primitives
  oracles,        % Oracle notation
  events,         % Event notation for probability
  complexity,     % Complexity theory notation
  asymptotics,    % Asymptotic notation
  keys,           % Key-related notation
  n,              % Security parameter n
  lambda          % Security parameter lambda
]{cryptocode}
\usepackage{nicodemus}
\usepackage{orcidlink}
\usepackage{pseudocodemacros}
\usepackage{todonotes}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{mdframed}
\usepackage{cleveref} % Must be loaded after hyperref and most other packages
\usepackage{macros}

% Configure hyperref colors
\hypersetup{
  colorlinks=true,
  linkcolor=blue,        % Internal links (sections, figures, etc.)
  citecolor=purple,       % Bibliography citations - changed to purple
  filecolor=magenta,      % File links
  urlcolor=blue           % URL links
}

% Configure backref display format
\renewcommand*{\backrefsep}{, }
\renewcommand*{\backreftwosep}{, }
\renewcommand*{\backreflastsep}{, }
\renewcommand*{\backref}[1]{%
  \ifx#1\relax%
  \else%
  p.~#1%
  \fi%
}
\renewcommand*{\backrefalt}[4]{%
  \ifcase #1 %
  % No citations
  \or
  % One citation
  p.~#2%
  \else
  % Multiple citations
  p.~#2%
  \fi
}
